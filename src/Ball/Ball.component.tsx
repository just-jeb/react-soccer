import { IPoint } from '../types/common.types';
import React, { useRef } from 'react';
import { CELL_SIZE } from '../constants';
import { EGameStatus } from '../types';
import styles from './Ball.module.scss';

interface BallComponentProps {
  ballPosition: IPoint;
  direction: 'left' | 'right';
  gameStatus: EGameStatus;
}

const BALL_SIZE = 74.85;
const BALL_CENTER = BALL_SIZE / 2;

//TODO: use svg asset instead of inline

export const BallComponent = React.memo<BallComponentProps>(
  ({ ballPosition: { x, y }, direction, gameStatus }) => {
    let [start, end] = direction === 'right' ? [0, 360] : [360, 0];
    const endAnimation = useRef<SVGElement>(null);
    endAnimation.current?.addEventListener('startEvent', () =>
      console.log('HELLO'),
    );
    return (
      <g
        transform={`translate(${x * CELL_SIZE - BALL_CENTER},${
          y * CELL_SIZE - BALL_CENTER
        })`}
      >
        <g
          id="Ball"
          className={gameStatus === EGameStatus.End ? styles.move : ''}
        >
          {gameStatus !== EGameStatus.End && (
            <animateTransform
              d="xxx"
              ref={endAnimation}
              additive={'sum'}
              attributeName="transform"
              attributeType={'XML'}
              type={'rotate'}
              from={`${start} ${BALL_CENTER} ${BALL_CENTER}`}
              to={`${end} ${BALL_CENTER} ${BALL_CENTER}`}
              dur={'10s'}
              repeatCount={'indefinite'}
            />
          )}
          {
            <>
              {/* <animateTransform
                attributeName="transform"
                attributeType={'XML'}
                additive={'sum'}
                type={'translate'}
                to={`${500} 500`}
                dur={'1s'}
              /> */}
            </>
          }
          <path
            d="M23.3429452,2.73868493 C18.7002123,4.6210137 14.5342671,7.38865753 10.9619795,10.959911 C7.38865753,14.5321986 4.62411644,18.6991781 2.74075342,23.3408767 C0.922547945,27.8253699 5.14413474e-14,32.5642877 5.14413474e-14,37.4252466 C5.14413474e-14,42.2851712 0.922547945,47.024089 2.74075342,51.5065137 C4.62411644,56.1492466 7.38969178,60.316226 10.9619795,63.8874795 C14.5342671,67.4608014 18.6991781,70.2263767 23.3429452,72.1087055 C27.8274384,73.9289795 32.5653219,74.8484247 37.4262808,74.8484247 C42.2872397,74.8484247 47.024089,73.9258767 51.5085822,72.1087055 C56.1502808,70.2263767 60.3182945,67.4608014 63.8895479,63.8874795 C67.4628699,60.316226 70.2284452,56.1513151 72.110774,51.5065137 C73.9289795,47.024089 74.8494589,42.2851712 74.8494589,37.4252466 C74.8494589,32.5642877 73.9279452,27.8253699 72.110774,23.3408767 C70.2284452,18.6991781 67.4608014,14.5311644 63.8895479,10.959911 C60.3182945,7.38865753 56.1544178,4.6210137 51.5085822,2.73868493 C47.024089,0.921513699 42.2872397,-5.87901113e-14 37.4262808,-5.87901113e-14 C32.5653219,-5.87901113e-14 27.8274384,0.921513699 23.3429452,2.73868493 Z"
            id="Path"
            fill="#FFFEF9"
          />
          <path
            d="M23.3429452,2.73868493 C18.7002123,4.6210137 14.5342671,7.38865753 10.9619795,10.959911 C7.38865753,14.5321986 4.62411644,18.6991781 2.74075342,23.3408767 C0.922547945,27.8253699 0,32.5642877 0,37.4252466 C0,42.2851712 0.922547945,47.024089 2.74075342,51.5065137 C4.62411644,56.1492466 7.38969178,60.316226 10.9619795,63.8874795 C14.5342671,67.4608014 18.6991781,70.2263767 23.3429452,72.1087055 C27.8274384,73.9289795 32.5653219,74.8484247 37.4262808,74.8484247 C42.2872397,74.8484247 47.024089,73.9258767 51.5085822,72.1087055 C56.1502808,70.2263767 60.3182945,67.4608014 63.8895479,63.8874795 C67.4628699,60.316226 70.2284452,56.1513151 72.110774,51.5065137 C73.9289795,47.024089 74.8494589,42.2851712 74.8494589,37.4252466 C74.8494589,32.5642877 73.9279452,27.8253699 72.110774,23.3408767 C70.2284452,18.6991781 67.4608014,14.5311644 63.8895479,10.959911 C60.3182945,7.38865753 56.1544178,4.6210137 51.5085822,2.73868493 C47.024089,0.921513699 42.2872397,0 37.4262808,0 C32.5653219,0 27.8274384,0.921513699 23.3429452,2.73868493 Z M9.35372603,53.1799247 C7.55103425,52.0484589 5.89003425,50.7453082 4.41933562,49.2104863 C2.17295205,42.8891712 1.79234932,36.0455616 3.28063014,29.5494589 C3.98081507,28.1687397 4.77718493,26.8428356 5.6780137,25.5727808 C5.95622603,25.1808014 6.21375342,24.772274 6.51161644,24.3916712 L14.957274,29.3891507 C14.957274,29.4553425 14.957274,29.5277397 14.957274,29.6011712 C14.9355548,34.1435822 15.3968288,38.6528973 16.3152397,43.0970548 C16.3183425,43.1177397 16.3214452,43.1291164 16.3255822,43.1477329 L9.77569863,53.4178014 C9.6329726,53.3454041 9.49128082,53.2668014 9.35372603,53.1799247 Z M34.4652329,70.5418219 C35.9224863,71.2854452 37.4211096,71.9132329 38.9611027,72.4241507 C32.4194932,72.7085685 25.812726,71.1758151 19.9723356,67.8248562 L34.130137,70.3473836 C34.2387329,70.4166781 34.3493973,70.4828699 34.4652329,70.5418219 Z M34.4135205,67.9861986 L17.7063014,65.0086027 C15.7515753,62.6350068 13.9933562,60.1238562 12.4823219,57.4399863 C12.0975822,56.7573836 11.6683699,56.0944315 11.3425822,55.3818356 L17.8862603,45.1221096 C18.0310548,45.1583082 18.1923973,45.1965753 18.3754589,45.2451849 C22.4690068,46.3404521 26.6349521,47.1192397 30.8298562,47.7294452 C31.0749726,47.7635753 31.2797534,47.7935685 31.4545411,47.8121849 L39.2982671,61.3742603 C37.9371986,63.2876164 36.5606164,65.1906301 35.1540411,67.0729589 C34.9203014,67.3863356 34.6720822,67.6873014 34.4135205,67.9861986 Z M62.2099315,62.2088973 C60.8798904,63.5399726 59.4681438,64.7396986 57.9902055,65.8091096 C57.745089,63.8502466 57.3220822,61.9306849 56.7253219,60.0555959 L65.0944452,44.4426096 C67.3997808,43.3928493 69.623411,42.2024315 71.6877671,40.7265616 C71.9577055,40.535226 72.182137,40.321137 72.3558904,40.0873973 C71.7498219,48.1555548 68.3678356,56.0520274 62.2099315,62.2088973 Z M61.838637,41.9604178 C62.1499452,42.5540753 62.4571164,43.1539384 62.7653219,43.7620753 L54.6816507,58.8413904 C54.6351096,58.8517329 54.590637,58.8620753 54.5440959,58.8682808 C50.1744041,59.6843014 45.7695479,60.1186849 41.3274589,60.1393699 L33.2603356,46.1904863 C34.515911,43.8592945 35.7601096,41.5187945 36.9939658,39.1772603 C37.8317055,37.5886575 38.6549658,35.9897123 39.4771918,34.3918014 L56.1730342,32.6770205 C58.2177397,35.6763356 60.1548836,38.739774 61.838637,41.9604178 Z M58.4514795,24.0741575 C57.6592466,26.1664384 56.8111644,28.237 55.9682534,30.3116986 L39.7036918,31.9820068 C39.5092534,31.7255137 39.3075753,31.4731575 39.0955548,31.2321781 C37.1749589,29.0571575 35.2419521,26.8955822 33.3120479,24.7278014 C33.3296301,24.7060822 33.3472123,24.6895342 33.3647945,24.6698836 C32.5860068,23.8921301 31.8051507,23.1143767 31.026363,22.3345548 L35.5542945,8.70215068 C35.866637,8.61941096 36.1810479,8.55011644 36.4985616,8.5159863 C38.9600685,8.26569863 41.4246781,7.98231507 43.8923904,7.83958904 C45.4034247,7.75478082 46.9227329,7.70617123 48.4596233,7.81476712 L59.6625822,20.4418836 C59.2768082,21.660226 58.9003425,22.8816712 58.4514795,24.0741575 Z M62.2099315,12.6395274 C65.3002603,15.7319247 67.6935068,19.260774 69.3855342,23.0306027 C67.2922192,21.5898973 65.0541096,20.4046507 62.7011986,19.4386644 C62.3350753,19.2876644 61.9596438,19.1542466 61.5780068,19.0228973 L50.5508699,6.59435616 C50.6274041,6.05758219 50.6677397,5.51977397 50.6842877,4.97782877 C54.8791918,6.68536986 58.8113973,9.2420274 62.2099315,12.6395274 Z M26.2016027,4.32521918 C26.2450411,4.35728082 26.265726,4.38417123 26.2905479,4.39141096 C28.8110068,5.26224658 31.1039315,6.54471233 33.2655068,8.06608904 L29.0354384,20.8049041 C29.0137192,20.8111096 28.9930342,20.8173151 28.9723493,20.8266233 C28.1066849,21.1844726 27.2244726,21.505089 26.3722534,21.8929315 C22.8609863,23.488774 19.4376301,25.2563014 16.2128493,27.3754726 L7.86544521,22.4369452 C7.87785616,22.1763151 7.92232877,21.9115479 8.01127397,21.6757397 C8.57183562,20.1822877 9.12308904,18.6805616 9.75708219,17.2171027 C10.2452466,16.089774 10.8016712,15.0007123 11.408774,13.9364726 C11.8059247,13.4979521 12.2175548,13.0635685 12.6415959,12.6395274 C16.605863,8.67629452 21.291,5.86210959 26.2791712,4.19800685 C26.2533151,4.23834247 26.2264247,4.28074658 26.2016027,4.32521918 Z"
            id="Shape"
            fill="#404040"
            fillRule="nonzero"
          />
        </g>
      </g>
    );
  },
);
